<?php
add_filter('pt-ocdi/import_files', 'nextpro_import_demo_data');
function nextpro_import_demo_data()
{
  return array(
    array(
      'import_file_name'           => 'Demo 1',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-01.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 2',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-02.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 3',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-03.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 4',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-04.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 5',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-05.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 6',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-06.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 7',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-07.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 8',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-08.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 9',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-09.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 10',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-10.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 11',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-11.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 12',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-12.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 13',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-13.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 14',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-14.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 15',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-15.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 16',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-16.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 17',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-17.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 18',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-18.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 19',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-19.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 20',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-20.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 21',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-21.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 22',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-22.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 23',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-23.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 24',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-24.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 25',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-25.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 26',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-26.jpg',
    ),
    array(
      'import_file_name'           => 'Demo 27',
      'import_file_url'            => NEXTPRO_URI . '/inc/demo-data/demo-content.xml',
      'import_widget_file_url'     => NEXTPRO_URI . '/inc/demo-data/widgets.wie',
      'preview_url'                => 'https://themeperch.net/nextpro/',
      'import_preview_image_url'   => NEXTPRO_ASSETS . '/images/demo-import/layout-27.jpg',
    ),
  );
}


function nextpro_demo_import_nav_menu_setup()
{
  // Assign menus to their locations.
  $topbar = get_term_by('name', 'Topbar menu', 'nav_menu');
  $topbar_social = get_term_by('name', 'Topbar social menu', 'nav_menu');
  $primary = get_term_by('name', 'Main Menu', 'nav_menu');
  $footer = get_term_by('name', 'Footer menu', 'nav_menu');
  $footer_social = get_term_by('name', 'Footer Social', 'nav_menu');
  set_theme_mod(
    'nav_menu_locations',
    array(
      //set topbar menu
      'topbar' => $topbar->term_id,
      'social' => $topbar_social->term_id,
      //set primary menu
      'primary' => $primary->term_id,
      //set footer menu
      'footer' => $footer->term_id,
      'footer_social' => $footer_social->term_id,
    )
  );
}

function nextpro_demo_import_page_on_front_setup($selected_import)
{
  if (get_option('page_on_front') != '') :
    // Assign front page and posts page (blog page).
    $front_page_id = get_page_by_title('Demo 1');
    $blog_page_id  = get_page_by_title('Home');

    update_option('show_on_front', 'page');
    update_option('page_on_front', $front_page_id->ID);
    update_option('page_for_posts', $blog_page_id->ID);
  endif;


  $home_pages = array('Demo 1', 'Demo 2', 'Demo 3', 'Demo 4', 'Demo 5', 'Demo 6', 'Demo 7', 'Demo 8', 'Demo 9', 'Demo 10', 'Demo 11', 'Demo 12', 'Demo 13', 'Demo 14', 'Demo 15', 'Demo 16', 'Demo 17', 'Demo 18', 'Demo 19', 'Demo 20', 'Demo 21', 'Demo 22', 'Demo 23', 'Demo 24', 'Demo 25', 'Demo 26', 'Demo 27');
  if (!in_array($selected_import['import_file_name'], $home_pages)) return;

  $pagename = trim($selected_import['import_file_name']);
  if ($pagename === $selected_import['import_file_name']) {
    $front_page_id = get_page_by_title($pagename);
    update_option('show_on_front', 'page');
    update_option('page_on_front', $front_page_id->ID);
  }
}

function nextpro_demo_import_social_share()
{
  if (!defined('ESSB3_OPTIONS_NAME')) return;
  ob_start();
  include __DIR__ . '/demo-data/essb3-options.json';
  $json = ob_get_clean();

  $options = json_decode($json, true, 512);
  update_option(ESSB3_OPTIONS_NAME, $options, true);
}

function nextpro_update_theme_mod()
{
  set_theme_mod('display_footer_top', true);
}

add_action('pt-ocdi/after_import', 'nextpro_after_import_setup', 10, 1);
function nextpro_after_import_setup($selected_import)
{
  nextpro_demo_import_nav_menu_setup();
  nextpro_demo_import_page_on_front_setup($selected_import);
  nextpro_update_theme_mod();
  nextpro_demo_import_social_share();
  flush_rewrite_rules(true);
}

function nextpro_before_content_import($selected_import)
{
  if (empty($selected_import['import_file_name'])) return;
  wp_delete_post(1, true); // remove hello world

}
add_action('ocdi/before_content_import', 'nextpro_before_content_import');
